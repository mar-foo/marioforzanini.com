<p>To manage my website I use 3 simple tools:</p>
<ul>
<li>Make (or mk on <a href="/plan9.html">9front</a>)</li>
<li><a href="http://codemadness.org/saait.html">saait</a></li>
<li><a href="http://github.com/Gottox/smu">smu</a></li>
</ul>
<h2>Workflow</h2>
<ol>
<li>Write a markdown document</li>
<li>Generate html source with Make (or mk)</li>
<li>Done</li>
</ol>
<h2>My setup</h2>
<p>This is the hierarchy of my website:</p>
<ul>
<li>Articles go in the root of the website</li>
<li>I put public files (like pictures and stylesheets) in <code>/pub</code></li>
<li>I handle everything that is not blogging-related in subdirectories</li>
</ul>
<h3>Adding an article</h3>
<p>I have copied and adapted page templates from the examples in saait
documentation, the only things I need to do to add a new <code>page.html</code>
entry to the website is:</p>
<ol>
<li>Add a link to it in the header template</li>
<li>Add it to the Makefile</li>
<li>Write the article (in smu markdown)</li>
<li>Add a <code>.cfg</code> file with some metadata:</li>
</ol>
<pre><code>filename = page.html
title = test page
description = no one ever reads this</code></pre>
<h3>Generating the html</h3>
<p>The structure enforced by saait looks like this:</p>
<pre><code>pages/ # the actual source
output/ # the result
templates/ # guess this one
config.cfg # global website config</code></pre>
<p>I simply add a Makefile in the root of the website:</p>
<pre><code>all: articles subdir1 subdir2
	find pages -type f -name &quot;*.cfg&quot; -print0 | sort -zr | xargs -0 saait
	cp style.css output/pub/

articles: pages
	cd pages ; $(MAKE) all

subdir1: subdir1
	cd subdir1 ; $(MAKE) all
	cp -r subdir1/output/* output/subdir1/

subdir2: subdir2
	cd subdir2 ; $(MAKE) all
	cp -r subdir2/output/* output/subdir2/</code></pre>
<pre><code>clean:
	rm output/*.html output/pub/*.css
	cd pages ; $(MAKE) clean
	cd subdir1 ; $(MAKE) clean
	cd subdir2 ; $(MAKE) clean

.PHONY: all clean</code></pre>
<p>and one in the <code>pages</code> directory:</p>
<pre><code>PAGES = article1.html \
        article2.html \
        article3.html

all: $(PAGES)

%.html: %.md
	smu $&lt; &gt; $@

clean:
	rm *.html

.PHONY: all clean</code></pre>
<p>Then I repeat this for every subdirectory.  Issuing <code>make</code> in the
root of the tree simply generates all html sources and moves them to
the <code>output</code> directory.</p>
<h2>Final structure</h2>
<p>This is what the tree of my website directory looks like in the end:</p>
<pre><code>Makefile
config.cfg
style.css
output/index.html
output/article1.html
output/article2.html
output/subdir1/index.html
output/subdir1/article.html
output/subdir2/article2.html
output/pub/style.css
output/pub/pics/pic1.png
pages/article1.cfg
pages/article1.html
pages/article1.md
pages/article2.cfg
pages/article2.html
pages/article2.md
pages/index.cfg
pages/index.html
pages/index.md
pages/Makefile
subdir1/Makefile
subdir1/config.cfg
subdir1/output/index.html
subdir1/output/article.html
subdir1/pages/article.cfg
subdir1/pages/article.html
subdir1/pages/article.md
subdir1/pages/index.cfg
subdir1/pages/index.html
subdir1/pages/index.md
subdir1/templates/page/footer.html
subdir1/templates/page/header.html
subdir1/templates/page/item.html
subdir2/Makefile
subdir2/config.cfg
subdir2/output/index.html
subdir2/output/article.html
subdir2/pages/article.cfg
subdir2/pages/article.html
subdir2/pages/article.md
subdir2/pages/index.cfg
subdir2/pages/index.html
subdir2/pages/index.md
subdir2/templates/page/footer.html
subdir2/templates/page/header.html
subdir2/templates/page/item.html
templates/page/footer.html
templates/page/header.html
templates/page/item.html</code></pre>
<h1>Final remarks</h1>
<p>I'm pleased with the result: the site is very fast (because it is
static), very easy to update (I don't need to write HTML by hand
anymore) and mantainable.</p>
